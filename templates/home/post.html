{% extends "home/layout.html" %}
{% block body %}
<link rel="stylesheet" href = "{{ url_for('static', filename='home/css/font-awesome.min.css')}}"/>
<script>
	function init(){
		$('#content').append($.parseHTML("{{post['content']}}"))
		
		$(window).scroll(function() {
			if($(window).scrollTop() + $(window).height() > $(document).height() - 100) {
				$(window).unbind('scroll');
				$.get("",loadcomments)
				$('#sub').prop("disabled", false);
			}
		});
	}
	
	
	loadcomments = function(){
		//instead of passing as a parameter make xhr call
		
		
		{% for i in range(0,n_comm)%}
			comments("name","comm")
		{%endfor%}
		
	}
	comments = function(name, comment){
		media = document.createElement('div')
		media.className = "media"
		media_left = document.createElement('div')
		media_left.className = "media-left"
		avatar = document.createElement('img')
		avatar.className = "media-object"
		avatar.style.width = "60px"
		avatar.src="/static/img_avatar1.png"
		media_left.appendChild(avatar)
		media.appendChild(media_left)
		media_body = document.createElement('div')
		media_body.className = "media-body"
		name_head = document.createElement('h4')
		name_head.className = "media-heading"
		name_head.innerHTML = name
		p= document.createElement('p')
		p.innerHTML = comment
		media_body.appendChild(name_head)
		media_body.appendChild(p)
		//to nest add another media here recursive call?
		media.appendChild(media_body)
		all = document.getElementById('comments')
		all.appendChild(media)
	}
</script>
<body onload="init()"> 
<div class="container">
	<br><br>
	<div id="content">
		
	</div>
	<br><br><br>
	<div class="container">
		<div id="comments">
			<i id='loader' class="fa fa-spinner fa-spin" style="font-size:48px;color:blue"></i>
		</div>
		<div id="add">
			<form class="form-horizontal">
				<div class="form-group">
					<label class="control-label col-sm-2" for="usr">Name:</label>
					<div class="col-sm-8">
					<input type="text" class="form-control" id="usr">
					</div>
				</div>
				<div class="form-group">
					<label class="control-label col-sm-2" for="comment">Comment:</label>
					<div class="col-sm-8"> 
					<textarea class="form-control" rows="5" id="comment"></textarea>
					</div> 
				</div>
				<div class="form-group"> 
					<div class="col-sm-offset-2 col-sm-10">
					<button type="submit" id='sub' class="btn btn-default" disabled>Submit</button>
					</div>
				</div>
			</form>
		</div>
	</div>
</div>
</body>
{% endblock %}
